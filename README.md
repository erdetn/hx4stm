# hx4stm

`hx4stm` is a command-line tool designed to simplify the integration of STM32 projects (created with STM32CubeMX) into the Helix Editor. The tool generates a .clangd file that includes the necessary compiler flags and paths to resolve missing headers and definitions, ensuring a smooth coding experience.
Features

- Automatically reads parameters and include paths from the `.mxproject` file and `Debug/Core/Src/subdir.mk` file.
- Generates a `.clangd` configuration file with all required paths and `#define` flags.
- Supports optional addition of `-Wall` flag for additional compiler warnings.

## How It Works

1. Extract Parameters and Paths:
    - Reads the `.mxproject` file to find include paths.
    - Parses `Debug/Core/Src/subdir.mk` to extract #define flags.

2. Generate .clangd File:
    - Constructs a `.clangd` file with all include paths and compiler flags.
    - Optionally includes `-Wall` if specified.

3. Integrate with Helix:
    - Place the generated `.clangd` file in the STM32 project root directory.
    - Helix will now properly resolve headers and flags.

## Installation

1. Clone the repository:
```
git clone https://github.com/erdetn/hx4stm
cd hx4stm
```

2. Build the tool:
```
go build -o hx4stm
```

3. Add the executable to your `$PATH` for easy access:
```
mv hx4stm /usr/local/bin/
```

## Usage

Run the tool in the root directory of your STM32 project:
```
hx4stm [options]
```

### Options

| Option | Description	| Default| 
|---|---|---| 
| -Wall	| Adds the `-Wall` flag to the .clangd file. | Disabled |

### Example

To generate a `.clangd` file with the `-Wall` flag:

```
hx4stm -Wall
```

Output

The generated `.clangd` file will look similar to the following:
```yaml
#.clangd
CompileFlags:
  Add: [ -DDEFINE1, -DDEFINE2, -I/project/root/Inc, -I/project/root/Middlewares/Inc, -Wall ]
```

## Troubleshooting
Common Errors
- "Failed to load .mxproject file": Ensure the .mxproject file exists in the project root directory.
- "Failed to find header paths": Check the .mxproject file for the HeaderPath entry.
- "Failed to read subdir.mk": Ensure that the STM32 project has been built and the subdir.mk file exists.

## Important Note

This tool was developed and tested using specific STM32 projects. While it works for these cases, it may not generalize to all STM32 projects generated by STM32 development tools.

If you encounter a project that is not handled correctly by `hx4stm`, please report the issue along with the relevant project files and configurations so the tool can be improved to cover more cases.

## License

This project is licensed under the MIT License.
